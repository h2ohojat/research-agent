<!-- backend/apps/frontend/templates/frontend/includes/composer.html -->
<!-- Composer Component -->
<div class="composer">
  <textarea id="{{ textarea_id }}" class="textarea" placeholder="Give me any task to work on…" wrap="soft" aria-label="{{ aria_label|default:'Enter your message' }}"></textarea>
  <div class="composer-bar">
    <div class="composer-left">
      <span class="credits" role="status" aria-label="Credits remaining: 87">
        <svg class="icon-database" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true">
          <ellipse cx="12" cy="5" rx="8" ry="3"></ellipse>
          <path d="M4 5v6c0 1.7 3.6 3 8 3s8-1.3 8-3V5"></path>
          <path d="M4 11v6c0 1.7 3.6 3 8 3s8-1.3 8-3v-6"></path>
        </svg>
        <span>87</span>
      </span>
      
      <button class="btn btn-square" aria-label="Attach file">
        <svg class="icon-paperclip" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true">
          <path d="M21.44 11.05l-8.49 8.49a5.5 5.5 0 0 1-7.78-7.78l8.49-8.49a3.5 3.5 0 0 1 4.95 4.95l-8.49 8.49a1.5 1.5 0 0 1-2.12-2.12l7.78-7.78"></path>
        </svg>
      </button>
      
      <button class="chip icon-only" id="{{ deep_btn_id }}" aria-label="Toggle Deep Search" aria-pressed="false">
        <svg class="icon-search" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true">
          <circle cx="11" cy="11" r="7"></circle>
          <line x1="21" y1="21" x2="16.65" y2="16.65"></line>
        </svg>
      </button>
      
      <!-- ✨✨✨ START: CRITICAL FIX FOR MODEL SELECTOR ✨✨✨ -->
      <!-- The container now has the correct ID and initial button structure. -->
      <div class="model-selector">
        <button class="chip model-select-trigger" data-role="model-trigger">
            <!-- The label will be updated by JS -->
            <span class="model-trigger-label" data-slot="label">Select a model</span>
            <svg class="chevron" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="6 9 12 15 18 9"></polyline></svg>
        </button>
      </div>
      <!-- ✨✨✨ END: CRITICAL FIX FOR MODEL SELECTOR ✨✨✨ -->

    </div>
    
    <button class="btn btn-primary btn-square" id="{{ send_btn_id }}" aria-label="Send message">
      <svg class="icon-arrow-up" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true">
        <polyline points="7 11 12 6 17 11"></polyline>
        <line x1="12" y1="6" x2="12" y2="18"></line>
      </svg>
    </button>
  </div>
</div>